<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>åŠ¨ç”»æ•ˆæœå±•ç¤º | Animation Showcase</title>
    <style>
        /* --- å…¨å±€ä¸åŸºç¡€æ ·å¼ --- */
        :root {
            --primary-color: #007AFF;
            --background-color: #f8f8f8;
            --card-background: #ffffff;
            --text-color: #333;
            --subtle-gray: #e5e5e5;
            --shadow-color: rgba(0, 0, 0, 0.1);
            --transition-duration-normal: 0.4s;
            --transition-duration-fast: 0.2s;
            --transition-duration-slow: 0.8s;
            --timing-function-smooth: cubic-bezier(0.4, 0, 0.2, 1);
            --timing-function-apple: cubic-bezier(0.32, 0.72, 0, 1);
            --timing-function-bounce: cubic-bezier(0.175, 0.885, 0.32, 1.275);
        }

        * {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        html {
            /* ä¸åœ¨è¿™é‡Œè®¾ç½® overflow: hidden; ç”± JS åŠ¨æ€æ§åˆ¶ */
            /* é»˜è®¤ overflow: auto; */
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif, "Apple Color Emoji", "Segoe UI Emoji", "Segoe UI Symbol";
            background-color: var(--background-color);
            color: var(--text-color);
            line-height: 1.6;
            padding: 30px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow-x: hidden;
            overflow-y: auto; /* é»˜è®¤å…è®¸ Y è½´æ»šåŠ¨ */
            min-height: 100vh;
            position: relative;
        }

        /* å½“å…¨å±è¦†ç›–å±‚æ‰“å¼€æ—¶ï¼Œç¦æ­¢ body æ»šåŠ¨ (è™½ç„¶æ§åˆ¶äº†html, ä¿ç•™è¿™ä¸ªä½œä¸ºåŒé‡ä¿é™©æˆ–ç‰¹å®šæƒ…å†µå¤„ç†) */
        body.fullscreen-open {
            overflow: hidden;
        }

        h1, h2 {
            text-align: center;
            margin-bottom: 30px;
            color: #1d1d1f;
        }

        h2 {
            margin-top: 40px;
            margin-bottom: 20px;
            border-bottom: 1px solid var(--subtle-gray);
            padding-bottom: 10px;
            width: 100%;
            max-width: 800px;
        }

        .container {
            display: flex;
            flex-wrap: wrap;
            gap: 30px;
            justify-content: center;
            width: 100%;
            max-width: 1000px;
        }

        .showcase-section {
            background-color: var(--card-background);
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 4px 15px var(--shadow-color);
            flex: 1 1 400px;
            min-width: 300px;
            display: flex;
            flex-direction: column;
            align-items: center;
            overflow: hidden;
        }

        /* --- 1. å›¾æ ‡ç‚¹å‡»æ”¾å¤§åˆ°å…¨å± --- */
        .app-icons-container {
            display: flex;
            gap: 20px;
            flex-wrap: wrap;
            justify-content: center;
            margin-top: 10px;
        }

        .app-icon {
            width: 80px;
            height: 80px;
            background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%);
            border-radius: 18px;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 30px;
            color: white;
            cursor: pointer;
            transition: transform var(--transition-duration-fast) ease;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
            will-change: transform;
            position: relative;
        }
        .app-icon.icon-2 { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); }
        .app-icon.icon-3 { background: linear-gradient(135deg, #84fab0 0%, #8fd3f4 100%); }

        .app-icon:active {
            transform: scale(0.9);
        }

        .fullscreen-overlay {
            position: fixed;
            z-index: 1100;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            overflow: hidden;
            pointer-events: none;
            opacity: 0;
            top: 0; left: 0; width: 0; height: 0;
            border-radius: 0;
            background: transparent;
            transform: translate3d(0, 0, 0);
            will-change: top, left, width, height, border-radius, opacity, background-color;
        }

        .fullscreen-overlay.opening,
        .fullscreen-overlay.closing,
        .fullscreen-overlay.open {
            pointer-events: auto;
        }

        .fullscreen-overlay.open {
            top: 0; left: 0; width: 100vw; height: 100vh;
            border-radius: 0px;
            opacity: 1;
            background-color: var(--card-background);
        }

        .fullscreen-content {
            width: 100%; height: 100%;
            padding: 40px;
            opacity: 0;
            transition: opacity 0.2s ease-in 0.2s;
            text-align: center;
            overflow-y: auto;
            will-change: opacity;
            position: relative;
            z-index: 1;
        }
        .fullscreen-overlay.open .fullscreen-content {
            opacity: 1;
        }

        .fullscreen-close-btn {
            position: absolute;
            top: 20px; right: 20px;
            width: 40px; height: 40px;
            background-color: rgba(0, 0, 0, 0.1);
            border: none;
            border-radius: 50%;
            font-size: 20px;
            color: #555;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            line-height: 1;
            opacity: 0;
            transform: scale(0.8);
            transition: opacity 0.3s ease 0.2s, transform 0.3s ease 0.2s, background-color 0.3s ease;
            z-index: 1110;
            will-change: opacity, transform;
            pointer-events: none;
        }
        .fullscreen-overlay.open .fullscreen-close-btn {
            opacity: 1;
            transform: scale(1);
            pointer-events: auto;
        }
        .fullscreen-close-btn:hover {
            background-color: rgba(0, 0, 0, 0.2);
            transform: scale(1.1);
        }

        /* --- å…¶ä»–æ ·å¼ (Card Flip, Content Switch, Modal, Buttons, Hover Effects, Responsive) ä¿æŒä¸å˜ --- */
        /* --- 2. å¡ç‰‡ç¿»è½¬æ•ˆæœ (Card Flip) --- */
        .card-container { width: 250px; height: 350px; perspective: 1000px; cursor: pointer; }
        .card { width: 100%; height: 100%; position: relative; transform-style: preserve-3d; transition: transform var(--transition-duration-slow) var(--timing-function-smooth); will-change: transform; border-radius: 10px; box-shadow: 0 5px 20px rgba(0,0,0,0.15); }
        .card.is-flipped { transform: rotateY(180deg); }
        .card-face { position: absolute; width: 100%; height: 100%; backface-visibility: hidden; border-radius: 10px; display: flex; flex-direction: column; justify-content: center; align-items: center; padding: 20px; text-align: center; font-size: 1.2em; will-change: transform, opacity; }
        .card-front { background: linear-gradient(135deg, #f6d365 0%, #fda085 100%); color: white; }
        .card-back { background: linear-gradient(135deg, #a1c4fd 0%, #c2e9fb 100%); color: #334; transform: rotateY(180deg); }
        .card-face h3 { margin-bottom: 15px; }
        .card-face p { font-size: 0.9em; }

        /* --- 3. å†…å®¹åˆ‡æ¢æ•ˆæœ --- */
        .content-switch-container { width: 100%; max-width: 400px; overflow: hidden; position: relative; min-height: 150px; border: 1px solid var(--subtle-gray); border-radius: 8px; }
        .content-switch-buttons { display: flex; border-bottom: 1px solid var(--subtle-gray); }
        .switch-btn { flex: 1; padding: 12px 15px; background-color: #f0f0f0; border: none; cursor: pointer; font-size: 0.95em; font-weight: 500; transition: background-color 0.3s ease, color 0.3s ease; color: #555; position: relative; outline: none; }
        .switch-btn:first-child { border-top-left-radius: 7px; }
        .switch-btn:last-child { border-top-right-radius: 7px; }
        .switch-btn:not(:last-child) { border-right: 1px solid var(--subtle-gray); }
        .switch-btn.active { background-color: var(--card-background); color: var(--primary-color); font-weight: 600; }
        .switch-btn.active::after { content: ''; position: absolute; bottom: -1px; left: 0; width: 100%; height: 3px; background-color: var(--primary-color); transition: transform var(--transition-duration-normal) var(--timing-function-smooth); transform-origin: center; }
        .content-panes { position: relative; padding: 20px; min-height: 100px; }
        .content-pane { opacity: 0; transform: translateX(20px); transition: opacity var(--transition-duration-normal) var(--timing-function-smooth), transform var(--transition-duration-normal) var(--timing-function-smooth), visibility 0s linear var(--transition-duration-normal); visibility: hidden; position: absolute; top: 20px; left: 20px; right: 20px; will-change: opacity, transform, visibility; }
        .content-pane.active { opacity: 1; transform: translateX(0); visibility: visible; position: relative; top: auto; left: auto; right: auto; transition-delay: 0s; transition: opacity var(--transition-duration-normal) var(--timing-function-smooth), transform var(--transition-duration-normal) var(--timing-function-smooth), visibility 0s; }

        /* --- 4. æ¨¡æ€å¼¹çª—æ•ˆæœ --- */
        .modal-trigger-btn { padding: 10px 20px; background-color: var(--primary-color); color: white; border: none; border-radius: 8px; cursor: pointer; font-size: 1em; transition: background-color 0.3s ease, transform 0.2s ease; }
        .modal-trigger-btn:hover { background-color: #0056b3; transform: translateY(-2px); }
        .modal-trigger-btn:active { transform: translateY(0px) scale(0.98); }
        .modal-overlay { position: fixed; top: 0; left: 0; width: 100%; height: 100%; background-color: rgba(0, 0, 0, 0.6); display: flex; justify-content: center; align-items: center; opacity: 0; visibility: hidden; transition: opacity var(--transition-duration-normal) var(--timing-function-smooth), visibility 0s linear var(--transition-duration-normal); z-index: 1000; will-change: opacity, visibility; }
        .modal-overlay.open { opacity: 1; visibility: visible; transition-delay: 0s; }
        .modal-content { background-color: var(--card-background); padding: 30px; border-radius: 12px; width: 90%; max-width: 500px; box-shadow: 0 10px 30px rgba(0, 0, 0, 0.2); transform: scale(0.95) translateY(10px); opacity: 0; transition: transform var(--transition-duration-normal) var(--timing-function-bounce), opacity var(--transition-duration-normal) var(--timing-function-smooth); position: relative; will-change: transform, opacity; }
        .modal-overlay.open .modal-content { transform: scale(1) translateY(0); opacity: 1; }
        .modal-close-btn { position: absolute; top: 10px; right: 15px; background: none; border: none; font-size: 24px; font-weight: bold; color: #aaa; cursor: pointer; padding: 5px; line-height: 1; transition: color 0.3s ease, transform 0.3s ease; z-index: 1010; }
        .modal-close-btn:hover { color: #333; transform: rotate(90deg) scale(1.1); }
        .modal-content h3 { margin-bottom: 15px; }

        /* --- 5. æŒ‰é’®ç‚¹å‡»ä¸æ‚¬æµ®æ•ˆæœ --- */
        .button-effects-container { display: flex; gap: 15px; flex-wrap: wrap; justify-content: center; }
        .btn { padding: 10px 20px; border-radius: 8px; font-size: 1em; cursor: pointer; border: 1px solid transparent; transition: all 0.3s var(--timing-function-smooth); outline: none; }
        .btn-scale { background-color: #6f42c1; color: white; }
        .btn-scale:hover { transform: scale(1.08); box-shadow: 0 4px 12px rgba(111, 66, 193, 0.4); }
        .btn-scale:active { transform: scale(0.95); transition-duration: var(--transition-duration-fast); }
        .btn-color-shift { background-color: #28a745; color: white; }
        .btn-color-shift:hover { background-color: #218838; transform: translateY(-3px); box-shadow: 0 6px 15px rgba(40, 167, 69, 0.3); }
        .btn-color-shift:active { transform: translateY(0px) scale(0.98); transition-duration: var(--transition-duration-fast); }
        .btn-border-reveal { background-color: #f0f0f0; color: #333; border: 1px solid #ccc; }
        .btn-border-reveal:hover { border-color: var(--primary-color); color: var(--primary-color); transform: scale(1.03); }
        .btn-border-reveal:active { background-color: #e0e0e0; transform: scale(0.97); transition-duration: var(--transition-duration-fast); }
        .btn-pulse { background-color: #fd7e14; color: white; overflow: hidden; position: relative; will-change: transform, box-shadow; }
        .btn-pulse:hover { animation: pulse-effect 1.2s infinite ease-in-out; }
        @keyframes pulse-effect { 0% { transform: scale(1); box-shadow: 0 0 0 0 rgba(253, 126, 20, 0.5); } 70% { transform: scale(1.05); box-shadow: 0 0 0 10px rgba(253, 126, 20, 0); } 100% { transform: scale(1); box-shadow: 0 0 0 0 rgba(253, 126, 20, 0); } }
        .btn-pulse:active { transform: scale(0.95); animation: none; transition-duration: var(--transition-duration-fast); }

        /* --- 6. æ‚¬æµ®æ•ˆæœ --- */
        .hover-effects-container { display: flex; gap: 20px; flex-wrap: wrap; justify-content: center; }
        .hover-box { width: 120px; height: 120px; border-radius: 10px; display: flex; justify-content: center; align-items: center; text-align: center; font-size: 0.9em; transition: all var(--transition-duration-normal) var(--timing-function-smooth); will-change: transform, box-shadow, background-color, color, border-color; }
        .hover-grow-shadow { background-color: #e9ecef; color: #495057; border: 1px solid #ced4da; }
        .hover-grow-shadow:hover { transform: scale(1.1) translateY(-5px); box-shadow: 0 12px 25px rgba(0, 0, 0, 0.15); border-color: transparent; background-color: #f8f9fa; }
        .hover-fill-color { background-color: transparent; color: var(--primary-color); border: 2px solid var(--primary-color); }
        .hover-fill-color:hover { background-color: var(--primary-color); color: white; transform: scale(1.05); }

        /* --- å“åº”å¼è°ƒæ•´ --- */
        @media (max-width: 768px) { body { padding: 20px; } h1 { font-size: 1.8em; } h2 { font-size: 1.3em; } .container { gap: 20px; } .showcase-section { flex-basis: 100%; padding: 20px; } .card-container { width: 200px; height: 280px; } .hover-box { width: 100px; height: 100px; } .app-icon { width: 70px; height: 70px; border-radius: 16px; font-size: 26px; } .fullscreen-close-btn { top: 15px; right: 15px; width: 35px; height: 35px; font-size: 18px;} }
        @media (max-width: 480px) { h1 { font-size: 1.5em; } h2 { font-size: 1.1em; margin-top: 30px; margin-bottom: 15px; } body { padding: 15px; } .button-effects-container .btn, .modal-trigger-btn { width: 100%; margin-bottom: 10px; } .button-effects-container { gap: 10px; } .hover-effects-container { gap: 15px; } .modal-content { padding: 20px; width: 95%; } .modal-close-btn { font-size: 20px; top: 8px; right: 10px; } .app-icon { width: 60px; height: 60px; border-radius: 14px; font-size: 24px; } .fullscreen-close-btn { top: 15px; right: 15px; width: 35px; height: 35px; font-size: 18px;} .fullscreen-content { padding: 30px 20px;} }

    </style>
</head>
<body>

<h1>å‰ç«¯åŠ¨ç”»æ•ˆæœå±•ç¤º</h1>
<p style="text-align: center; margin-bottom: 40px; max-width: 600px; color: #555;">
    è¿™æ˜¯ä¸€ä¸ªä½¿ç”¨çº¯ CSS å’Œ JavaScript å®ç°çš„å¸¸è§ Web åŠ¨ç”»æ•ˆæœç¤ºä¾‹é¡µé¢ï¼ŒåŒ…å«å›¾æ ‡æ”¾å¤§ã€å¡ç‰‡åˆ‡æ¢ã€å¼¹çª—ç­‰å¤šç§æ•ˆæœã€‚
</p>

<div class="container">
    <!-- Section 1: App Open Animation -->
    <div class="showcase-section">
        <h2>1. App æ‰“å¼€åŠ¨ç”»</h2>
        <p style="margin-bottom: 15px; font-size: 0.9em; color: #666; text-align: center;">ç‚¹å‡»å›¾æ ‡ä½“éªŒæ”¾å¤§åŠ¨ç”»ã€‚</p>
        <div class="app-icons-container">
            <div class="app-icon" data-app-id="app1" title="æ‰“å¼€ App 1">ğŸ“±</div>
            <div class="app-icon icon-2" data-app-id="app2" title="æ‰“å¼€ App 2">â­</div>
            <div class="app-icon icon-3" data-app-id="app3" title="æ‰“å¼€ App 3">ğŸ’¡</div>
        </div>
    </div>
    <!-- Section 2: Card Flip -->
    <div class="showcase-section">
        <h2>2. å¡ç‰‡ç¿»è½¬</h2>
        <p style="margin-bottom: 15px; font-size: 0.9em; color: #666; text-align: center;">ç‚¹å‡»å¡ç‰‡ç¿»è½¬ã€‚</p>
        <div class="card-container" id="flipCardContainer">
            <div class="card" id="flipCard">
                <div class="card-face card-front"><h3>æ­£é¢</h3><p>ç‚¹å‡»ç¿»è½¬</p>âœ¨</div>
                <div class="card-face card-back"><h3>èƒŒé¢</h3><p>å†æ¬¡ç‚¹å‡»</p>ğŸš€</div>
            </div>
        </div>
    </div>
    <!-- Section 3: Content Switch -->
    <div class="showcase-section">
        <h2>3. å†…å®¹åˆ‡æ¢</h2>
        <p style="margin-bottom: 15px; font-size: 0.9em; color: #666; text-align: center;">ç‚¹å‡»æŒ‰é’®åˆ‡æ¢å†…å®¹ã€‚</p>
        <div class="content-switch-container">
            <div class="content-switch-buttons">
                <button class="switch-btn active" data-target="pane1">é€‰é¡¹ä¸€</button>
                <button class="switch-btn" data-target="pane2">é€‰é¡¹äºŒ</button>
                <button class="switch-btn" data-target="pane3">é€‰é¡¹ä¸‰</button>
            </div>
            <div class="content-panes">
                <div class="content-pane active" id="pane1"><h4>å†…å®¹ 1</h4><p>åŒºåŸŸä¸€çš„æè¿°ã€‚</p></div>
                <div class="content-pane" id="pane2"><h4>å†…å®¹ 2</h4><p>åŒºåŸŸäºŒçš„æè¿°ã€‚</p></div>
                <div class="content-pane" id="pane3"><h4>å†…å®¹ 3</h4><p>åŒºåŸŸä¸‰çš„æè¿°ã€‚</p></div>
            </div>
        </div>
    </div>
    <!-- Section 4: Modal -->
    <div class="showcase-section">
        <h2>4. æ¨¡æ€å¼¹çª—</h2>
        <p style="margin-bottom: 15px; font-size: 0.9em; color: #666; text-align: center;">ç‚¹å‡»æŒ‰é’®æ‰“å¼€å¼¹çª—ã€‚</p>
        <button class="modal-trigger-btn" id="openModalBtn">æ‰“å¼€å¼¹çª—</button>
        <div class="modal-overlay" id="myModal">
            <div class="modal-content">
                <button class="modal-close-btn" id="closeModalBtn">Ã—</button>
                <h3>æ¨¡æ€å¼¹çª—æ ‡é¢˜</h3><p>å¼¹çª—å†…å®¹...</p>
            </div>
        </div>
    </div>
    <!-- Section 5: Button Effects -->
    <div class="showcase-section">
        <h2>5. æŒ‰é’®äº¤äº’</h2>
        <p style="margin-bottom: 15px; font-size: 0.9em; color: #666; text-align: center;">æŒ‰é’®æ‚¬æµ®ä¸ç‚¹å‡»æ•ˆæœã€‚</p>
        <div class="button-effects-container">
            <button class="btn btn-scale">ç¼©æ”¾</button>
            <button class="btn btn-color-shift">é¢œè‰²&ä½ç§»</button>
            <button class="btn btn-border-reveal">è¾¹æ¡†</button>
            <button class="btn btn-pulse">æ‚¬æµ®è„‰å†²</button>
        </div>
    </div>
    <!-- Section 6: Hover Effects -->
    <div class="showcase-section">
        <h2>6. å…ƒç´ æ‚¬æµ®</h2>
        <p style="margin-bottom: 15px; font-size: 0.9em; color: #666; text-align: center;">æ‚¬æµ®æ–¹å—æŸ¥çœ‹æ•ˆæœã€‚</p>
        <div class="hover-effects-container">
            <div class="hover-box hover-grow-shadow">æ”¾å¤§&é˜´å½±</div>
            <div class="hover-box hover-fill-color">å¡«å……é¢œè‰²</div>
        </div>
    </div>
</div>

<!-- Fullscreen Overlay -->
<div class="fullscreen-overlay" id="fullscreenOverlay">
    <button class="fullscreen-close-btn" id="fullscreenCloseBtn">Ã—</button>
    <div class="fullscreen-content" id="fullscreenContent"></div>
</div>

<script>
    document.addEventListener('DOMContentLoaded', () => {
        const htmlEl = document.documentElement; // è·å– <html> å…ƒç´ 
        const bodyEl = document.body; // è·å– <body> å…ƒç´ 

        // --- 1. å›¾æ ‡ç‚¹å‡»æ”¾å¤§åˆ°å…¨å± ---
        const icons = document.querySelectorAll('.app-icon');
        const fullscreenOverlay = document.getElementById('fullscreenOverlay');
        const fullscreenContent = document.getElementById('fullscreenContent');
        const fullscreenCloseBtn = document.getElementById('fullscreenCloseBtn');
        let currentIcon = null;
        let isAnimating = false;
        let transitionEndHandler = null;

        icons.forEach(icon => {
            icon.addEventListener('click', () => {
                if (isAnimating || fullscreenOverlay.classList.contains('open')) return;
                isAnimating = true;

                // **å…³é”®ä»£ç ï¼šå¼€å§‹æ‰“å¼€åŠ¨ç”»æ—¶ï¼Œéšè—æ»šåŠ¨æ¡**
                bodyEl.classList.add('fullscreen-open'); // æ§åˆ¶ body æ»šåŠ¨ (å¯é€‰, ä½†æ¨èä¿ç•™)
                htmlEl.style.overflow = 'hidden';     // æ§åˆ¶ html æ»šåŠ¨ (ä¸»è¦)

                currentIcon = icon;
                const iconRect = icon.getBoundingClientRect();
                const iconComputedStyle = window.getComputedStyle(icon);

                // 1. è®¾ç½®åˆå§‹çŠ¶æ€
                fullscreenOverlay.style.transition = 'none';
                fullscreenOverlay.style.top = `${iconRect.top}px`;
                fullscreenOverlay.style.left = `${iconRect.left}px`;
                fullscreenOverlay.style.width = `${iconRect.width}px`;
                fullscreenOverlay.style.height = `${iconRect.height}px`;
                fullscreenOverlay.style.borderRadius = iconComputedStyle.borderRadius;
                fullscreenOverlay.style.background = iconComputedStyle.background;
                fullscreenOverlay.style.backgroundColor = 'transparent';
                fullscreenOverlay.style.opacity = '1';
                fullscreenOverlay.classList.remove('open', 'closing');
                fullscreenOverlay.classList.add('opening');

                // å‡†å¤‡å†…å®¹
                const appId = icon.getAttribute('data-app-id');
                fullscreenContent.innerHTML = `<h2>App ${appId}</h2><p>è¿™æ˜¯ ${appId} çš„å†…å®¹ã€‚</p><img src="https://via.placeholder.com/300x200.png?text=${appId}" alt="${appId}" style="margin-top: 20px; max-width: 100%; border-radius: 8px;">`;
                fullscreenContent.style.opacity = '0';

                // 2. å¼ºåˆ¶é‡ç»˜
                void fullscreenOverlay.offsetHeight;

                // 3. å¯ç”¨è¿‡æ¸¡å¹¶è®¾ç½®ç›®æ ‡çŠ¶æ€
                fullscreenOverlay.style.transition = `top var(--transition-duration-normal) var(--timing-function-apple), left var(--transition-duration-normal) var(--timing-function-apple), width var(--transition-duration-normal) var(--timing-function-apple), height var(--transition-duration-normal) var(--timing-function-apple), border-radius var(--transition-duration-normal) var(--timing-function-apple), background-color var(--transition-duration-normal) var(--timing-function-apple), opacity var(--transition-duration-normal) var(--timing-function-apple)`;
                fullscreenOverlay.style.top = '0px';
                fullscreenOverlay.style.left = '0px';
                fullscreenOverlay.style.width = '100vw';
                fullscreenOverlay.style.height = '100vh';
                fullscreenOverlay.style.borderRadius = '0px';
                fullscreenOverlay.style.backgroundColor = 'var(--card-background)';

                // 4. åŠ¨ç”»ç»“æŸåå¤„ç†
                transitionEndHandler = (event) => {
                    if (event.target === fullscreenOverlay && ['width', 'opacity'].includes(event.propertyName)) {
                        fullscreenOverlay.classList.remove('opening');
                        fullscreenOverlay.classList.add('open');
                        isAnimating = false;
                        fullscreenOverlay.removeEventListener('transitionend', transitionEndHandler);
                        transitionEndHandler = null;
                    }
                };
                fullscreenOverlay.addEventListener('transitionend', transitionEndHandler);
            });
        });

        // å…³é—­å…¨å±åŠ¨ç”»
        function closeFullscreen() {
            if (isAnimating || !fullscreenOverlay.classList.contains('open') || !currentIcon) return;
            isAnimating = true;

            const iconRect = currentIcon.getBoundingClientRect();
            const iconComputedStyle = window.getComputedStyle(currentIcon);

            // 1. ç§»é™¤ open ç±»ï¼Œæ·»åŠ  closing ç±»
            fullscreenOverlay.classList.remove('open');
            fullscreenOverlay.classList.add('closing');

            // 2. è®¾ç½®åŠ¨ç”»ç›®æ ‡çŠ¶æ€
            fullscreenOverlay.style.transition = `top var(--transition-duration-normal) var(--timing-function-apple), left var(--transition-duration-normal) var(--timing-function-apple), width var(--transition-duration-normal) var(--timing-function-apple), height var(--transition-duration-normal) var(--timing-function-apple), border-radius var(--transition-duration-normal) var(--timing-function-apple), background-color var(--transition-duration-normal) var(--timing-function-apple), opacity var(--transition-duration-normal) var(--timing-function-apple)`;
            fullscreenOverlay.style.top = `${iconRect.top}px`;
            fullscreenOverlay.style.left = `${iconRect.left}px`;
            fullscreenOverlay.style.width = `${iconRect.width}px`;
            fullscreenOverlay.style.height = `${iconRect.height}px`;
            fullscreenOverlay.style.borderRadius = iconComputedStyle.borderRadius;
            fullscreenOverlay.style.background = iconComputedStyle.background;
            fullscreenOverlay.style.backgroundColor = 'transparent';

            // 3. åŠ¨ç”»ç»“æŸåå¤„ç†
            transitionEndHandler = (event) => {
                if (event.target === fullscreenOverlay && ['width', 'opacity'].includes(event.propertyName)) {
                    fullscreenOverlay.classList.remove('closing');
                    fullscreenOverlay.style.opacity = '0';
                    fullscreenOverlay.style.pointerEvents = 'none';

                    // **å…³é”®ä»£ç ï¼šç»“æŸå…³é—­åŠ¨ç”»æ—¶ï¼Œæ¢å¤æ»šåŠ¨æ¡**
                    bodyEl.classList.remove('fullscreen-open'); // æ¢å¤ body æ»šåŠ¨
                    htmlEl.style.overflow = ''; // æ¢å¤ html æ»šåŠ¨ (è®¾ä¸ºç©ºå­—ç¬¦ä¸²ï¼Œç§»é™¤å†…è”æ ·å¼)

                    currentIcon = null;
                    isAnimating = false;
                    fullscreenOverlay.removeEventListener('transitionend', transitionEndHandler);
                    transitionEndHandler = null;
                }
            };
            fullscreenOverlay.addEventListener('transitionend', transitionEndHandler);
        }

        // ç»‘å®šå…³é—­äº‹ä»¶
        fullscreenCloseBtn.addEventListener('click', closeFullscreen);
        document.addEventListener('keydown', (event) => {
            if (event.key === 'Escape' && fullscreenOverlay.classList.contains('open') && !isAnimating) {
                closeFullscreen();
            }
        });

        // --- 2. å¡ç‰‡ç¿»è½¬ ---
        const flipCardContainer = document.getElementById('flipCardContainer');
        const flipCard = document.getElementById('flipCard');
        if (flipCardContainer && flipCard) {
            flipCardContainer.addEventListener('click', () => flipCard.classList.toggle('is-flipped'));
        }

        // --- 3. å†…å®¹åˆ‡æ¢ ---
        const switchButtons = document.querySelectorAll('.switch-btn');
        const contentPanes = document.querySelectorAll('.content-pane');
        const contentSwitchContainer = document.querySelector('.content-switch-container');
        if (switchButtons.length > 0 && contentPanes.length > 0 && contentSwitchContainer) {
            switchButtons.forEach(button => {
                button.addEventListener('click', () => {
                    if (button.classList.contains('active')) return;
                    const targetPaneId = button.getAttribute('data-target');
                    const targetPane = document.getElementById(targetPaneId);
                    switchButtons.forEach(btn => btn.classList.remove('active'));
                    const currentActivePane = contentSwitchContainer.querySelector('.content-pane.active');
                    if(currentActivePane) currentActivePane.classList.remove('active');
                    button.classList.add('active');
                    if (targetPane) targetPane.classList.add('active');
                });
            });
        }

        // --- 4. æ¨¡æ€å¼¹çª— ---
        const openModalBtn = document.getElementById('openModalBtn');
        const closeModalBtn = document.getElementById('closeModalBtn');
        const modalOverlay = document.getElementById('myModal');
        if (openModalBtn && closeModalBtn && modalOverlay) {
            function openModal() {
                modalOverlay.classList.add('open');
                // ä¹Ÿå¯åœ¨æ­¤å¤„æ§åˆ¶æ»šåŠ¨ï¼Œä½† fullscreen çš„æ§åˆ¶ä¼˜å…ˆ
                // if (!bodyEl.classList.contains('fullscreen-open')) {
                //     htmlEl.style.overflow = 'hidden';
                // }
            }
            function closeModal() {
                modalOverlay.classList.remove('open');
                // æ¢å¤æ»šåŠ¨ï¼ŒåŒæ ·éœ€æ£€æŸ¥ fullscreen çŠ¶æ€
                // if (!bodyEl.classList.contains('fullscreen-open')) {
                //     htmlEl.style.overflow = '';
                // }
            }
            openModalBtn.addEventListener('click', openModal);
            closeModalBtn.addEventListener('click', closeModal);
            modalOverlay.addEventListener('click', (event) => { if (event.target === modalOverlay) closeModal(); });
            document.addEventListener('keydown', (event) => { if (event.key === 'Escape' && modalOverlay.classList.contains('open')) closeModal(); });
        }

        // --- 5 & 6. CSS Driven Effects ---
        console.log("DOM ready, listeners attached.");
    });
</script>

</body>
</html>